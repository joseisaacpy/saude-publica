<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Painel Admnistrativo</title>
    <link rel="stylesheet" href="./src/style.css" />
    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="./public/img/favicon/favicon-96x96.png"
      sizes="96x96"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="./public/img/favicon/favicon.svg"
    />
    <link rel="shortcut icon" href="./public/img/favicon/favicon.ico" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="./public/img/favicon/apple-touch-icon.png"
    />
    <link rel="manifest" href="./public/img/favicon/site.webmanifest" />
    <!-- Font-Awesome -->
    <script
      src="https://kit.fontawesome.com/5432a0e64c.js"
      crossorigin="anonymous"
    ></script>
    <!-- Poopins -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
  </head>

  <body class="font-poppins bg-slate-100">
    <!-- Header -->
    <header>
      <nav
        class="min-w-full flex items-center justify-between md:justify-around bg-azul_medio text-white p-4 shadow-md"
      >
        <a
          href="#"
          class="flex items-center hover:scale-110 transition-all duration-300"
        >
          <img
            src="./public/img/logo-saude-publica.png"
            class="w-16 h-16"
          /><span class="font-bold hidden md:block">Saúde Pública</span>
        </a>
        <ul class="hidden md:flex gap-4">
          <li>
            <a
              href="/"
              class="block font-bold text-white hover:scale-105 hover:text-amarelo transition-all"
              >Home</a
            >
          </li>
        </ul>
      </nav>
    </header>
    <!-- Main -->
    <main>
      <!-- Div Loading -->
      <div
        id="loader"
        class="fixed inset-0 flex flex-col items-center justify-center bg-white z-50"
      >
        <!-- Loader animado -->
        <div
          class="items-center transition-all animate-spin rounded-full h-28 w-28 border-t-4 border-b-4 border-azul_escuro"
        ></div>
        <!-- Mensagem de carregamento -->
        <span class="font-bold animate-pulse mt-4 text-2xl">Carregando...</span>
      </div>
      <!-- Section com cards informativos -->
      <section class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Professores -->
        <div class="bg-white rounded-xl p-4 shadow-2xl flex flex-col gap-2">
          <div class="text-black text-3xl">
            <i class="fas fa-chalkboard-teacher"></i>
          </div>
          <p class="text-gray-500 text-sm">Professores</p>
          <h2 class="text-2xl font-bold" id="professores-count">0</h2>
        </div>

        <!-- Alunos -->
        <div class="bg-white rounded-xl p-4 shadow-2xl flex flex-col gap-2">
          <div class="text-black text-3xl">
            <i class="fas fa-user-graduate"></i>
          </div>
          <p class="text-gray-500 text-sm">Alunos</p>
          <h2 class="text-2xl font-bold" id="alunos-count">0</h2>
        </div>

        <!-- Academias -->
        <div class="bg-white rounded-xl p-4 shadow-2xl flex flex-col gap-2">
          <div class="text-black text-3xl">
            <i class="fas fa-dumbbell"></i>
          </div>
          <p class="text-gray-500 text-sm">Academias</p>
          <h2 class="text-2xl font-bold" id="academias-count">0</h2>
        </div>

        <!-- Admins -->
        <div class="bg-white rounded-xl p-4 shadow-2xl flex flex-col gap-2">
          <div class="text-black text-3xl">
            <i class="fas fa-user-shield"></i>
          </div>
          <p class="text-gray-500 text-sm">Administradores</p>
          <h2 class="text-2xl font-bold" id="admin-count">0</h2>
        </div>
      </section>
    </main>
    <script type="module" src="./src/main.js"></script>
    <script>
      // Base da URL, mas será alterada de acordo com o ambiente (railway ou localhost)
      const baseURL = "http://localhost:3000/api";
      const loader = document.getElementById("loader");
      // Função pra pegar quantidade de elementos da API
      const fetchCount = async (rota, idElemento) => {
        try {
          const response = await fetch(`${baseURL}/${rota}`);
          const data = await response.json();
          document.getElementById(idElemento).textContent = data.length;
        } catch (err) {
          console.error(`Erro ao buscar ${rota}:`, err);
          document.getElementById(idElemento).textContent = "Erro";
        } finally {
          // Ao terminar de carregar os dados, esconde o loader
          loader.classList.add("hidden");
        }
      };

      fetchCount("professores", "professores-count");
      fetchCount("alunos", "alunos-count");
      fetchCount("academias", "academias-count");
      fetchCount("admin", "admin-count");
    </script>
  </body>
</html>
